<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemistry Liberation Lab - Educational Bot Engine</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a0033 0%, #330066 50%, #000022 100%);
            font-family: 'Courier New', monospace;
            color: #00ff88;
            overflow-x: hidden;
            user-select: none;
        }

        .lab-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            position: relative;
        }

        .lab-header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-bottom: 2px solid #00ff88;
        }

        .lab-title {
            font-size: 2.8em;
            font-weight: bold;
            text-shadow: 0 0 30px #00ff88;
            margin: 0;
            letter-spacing: 2px;
        }

        .lab-subtitle {
            font-size: 1.3em;
            color: #ffa502;
            margin: 10px 0;
            text-shadow: 0 0 15px #ffa502;
        }

        .lab-workspace {
            display: flex;
            flex: 1;
            gap: 20px;
            padding: 20px;
        }

        .experiment-area {
            flex: 2;
            background: rgba(0, 0, 0, 0.4);
            border: 3px solid #00ff88;
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }

        .reaction-chamber {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #001122, #002244);
            border: 2px solid #00ccff;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .molecule {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            color: white;
            text-shadow: 0 0 5px currentColor;
        }

        .molecule.hydrogen {
            background: radial-gradient(circle, #ff6b6b, #cc5555);
        }

        .molecule.oxygen {
            background: radial-gradient(circle, #00ccff, #0099cc);
        }

        .molecule.carbon {
            background: radial-gradient(circle, #333, #111);
        }

        .molecule.nitrogen {
            background: radial-gradient(circle, #00ff88, #00cc66);
        }

        .molecule.sodium {
            background: radial-gradient(circle, #ffa502, #cc8400);
        }

        .molecule.chlorine {
            background: radial-gradient(circle, #9b59b6, #8e44ad);
        }

        .molecule:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px currentColor;
        }

        .molecule.selected {
            transform: scale(1.3);
            box-shadow: 0 0 25px #fff;
            animation: selected-pulse 1s infinite alternate;
        }

        @keyframes selected-pulse {
            0% { box-shadow: 0 0 25px #fff; }
            100% { box-shadow: 0 0 35px #fff; }
        }

        .bond {
            position: absolute;
            height: 4px;
            background: linear-gradient(90deg, #fff, #ccc);
            transform-origin: left center;
            pointer-events: none;
            box-shadow: 0 0 5px #fff;
        }

        .bond.double {
            height: 6px;
            background: linear-gradient(90deg, #ffa502, #cc8400);
        }

        .bond.triple {
            height: 8px;
            background: linear-gradient(90deg, #ff6b6b, #cc5555);
        }

        .control-panel {
            flex: 1;
            background: rgba(0, 0, 0, 0.4);
            border: 3px solid #ffa502;
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .element-palette {
            background: rgba(255, 165, 2, 0.1);
            border: 2px solid #ffa502;
            border-radius: 10px;
            padding: 15px;
        }

        .palette-title {
            color: #ffa502;
            font-size: 1.2em;
            margin-bottom: 10px;
            text-align: center;
        }

        .element-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .element-btn {
            padding: 12px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            transition: all 0.3s ease;
            text-align: center;
        }

        .element-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .element-btn.hydrogen { background: linear-gradient(135deg, #ff6b6b, #cc5555); }
        .element-btn.oxygen { background: linear-gradient(135deg, #00ccff, #0099cc); }
        .element-btn.carbon { background: linear-gradient(135deg, #666, #333); }
        .element-btn.nitrogen { background: linear-gradient(135deg, #00ff88, #00cc66); }
        .element-btn.sodium { background: linear-gradient(135deg, #ffa502, #cc8400); }
        .element-btn.chlorine { background: linear-gradient(135deg, #9b59b6, #8e44ad); }

        .reaction-info {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px;
        }

        .reaction-info h3 {
            margin: 0 0 10px 0;
            color: #00ff88;
            font-size: 1.1em;
        }

        .formula-display {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid #00ccff;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            color: #00ccff;
            margin: 10px 0;
            text-align: center;
            font-size: 1.2em;
        }

        .reaction-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .lab-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #00ff88, #00cc66);
            border: none;
            border-radius: 8px;
            color: #000;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .lab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }

        .lab-btn.danger {
            background: linear-gradient(135deg, #ff6b6b, #cc5555);
            color: white;
        }

        .lab-btn.warning {
            background: linear-gradient(135deg, #ffa502, #cc8400);
            color: white;
        }

        .stats-display {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .stat-box {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #00ccff;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #ffa502;
            text-shadow: 0 0 10px #ffa502;
        }

        .compound-library {
            max-height: 150px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid #00ff88;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
        }

        .compound-item {
            padding: 5px;
            margin: 2px 0;
            background: rgba(0, 255, 136, 0.1);
            border-radius: 3px;
            font-size: 0.9em;
        }

        .reaction-explosion {
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 165, 2, 0.8), transparent);
            animation: explosion 1s ease-out;
            pointer-events: none;
        }

        @keyframes explosion {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ffa502, #ff6348);
            color: #000;
            padding: 15px 20px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 4px 20px rgba(255, 165, 2, 0.6);
            transform: translateX(350px);
            transition: transform 0.5s ease;
            z-index: 1000;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .lab-workspace {
                flex-direction: column;
            }
            
            .lab-title {
                font-size: 2.2em;
            }
            
            .reaction-chamber {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="lab-container">
        <div class="lab-header">
            <h1 class="lab-title">CHEMISTRY LIBERATION LAB</h1>
            <p class="lab-subtitle">⚗️ AI-ENHANCED MOLECULAR SYNTHESIS ENGINE ⚗️</p>
        </div>

        <div class="lab-workspace">
            <div class="experiment-area">
                <div class="reaction-chamber" id="reactionChamber"></div>
                
                <div class="formula-display" id="formulaDisplay">
                    Click elements to build molecules • Drag to create bonds
                </div>
            </div>

            <div class="control-panel">
                <div class="element-palette">
                    <div class="palette-title">LIBERATION ELEMENTS</div>
                    <div class="element-grid">
                        <button class="element-btn hydrogen" onclick="addElement('hydrogen')">H</button>
                        <button class="element-btn oxygen" onclick="addElement('oxygen')">O</button>
                        <button class="element-btn carbon" onclick="addElement('carbon')">C</button>
                        <button class="element-btn nitrogen" onclick="addElement('nitrogen')">N</button>
                        <button class="element-btn sodium" onclick="addElement('sodium')">Na</button>
                        <button class="element-btn chlorine" onclick="addElement('chlorine')">Cl</button>
                    </div>
                </div>

                <div class="stats-display">
                    <div class="stat-box">
                        <div class="stat-value" id="compounds">0</div>
                        <div>COMPOUNDS</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="reactions">0</div>
                        <div>REACTIONS</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="score">0</div>
                        <div>LAB SCORE</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="stability">100%</div>
                        <div>STABILITY</div>
                    </div>
                </div>

                <div class="reaction-info">
                    <h3>SYNTHESIS OBJECTIVES</h3>
                    <p id="objectiveText">Create basic compounds: H₂O, CO₂, NaCl, NH₃</p>
                    
                    <div class="compound-library" id="compoundLibrary">
                        <div style="text-align: center; color: #ccc;">No compounds discovered yet</div>
                    </div>
                </div>

                <div class="reaction-controls">
                    <button class="lab-btn" onclick="analyzeCompounds()">
                        🔍 ANALYZE STRUCTURE
                    </button>
                    <button class="lab-btn warning" onclick="createReaction()">
                        ⚡ TRIGGER REACTION
                    </button>
                    <button class="lab-btn danger" onclick="clearLab()">
                        🧹 CLEAR LAB
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="achievement-popup" id="achievementPopup">
        <div id="achievementText">Achievement Unlocked!</div>
    </div>

    <script src="assets/js/bot-audio-engine.js"></script>
    <script>
        class ChemistryLiberationLab {
            constructor() {
                this.elements = [];
                this.bonds = [];
                this.compounds = [];
                this.selectedElement = null;
                this.score = 0;
                this.reactions = 0;
                this.stability = 100;
                
                this.elementProperties = {
                    hydrogen: { symbol: 'H', valence: 1, color: '#ff6b6b' },
                    oxygen: { symbol: 'O', valence: 2, color: '#00ccff' },
                    carbon: { symbol: 'C', valence: 4, color: '#666' },
                    nitrogen: { symbol: 'N', valence: 3, color: '#00ff88' },
                    sodium: { symbol: 'Na', valence: 1, color: '#ffa502' },
                    chlorine: { symbol: 'Cl', valence: 1, color: '#9b59b6' }
                };
                
                this.knownCompounds = {
                    'H2O': { name: 'Water', formula: 'H₂O', points: 1000 },
                    'CO2': { name: 'Carbon Dioxide', formula: 'CO₂', points: 1500 },
                    'NaCl': { name: 'Salt', formula: 'NaCl', points: 800 },
                    'NH3': { name: 'Ammonia', formula: 'NH₃', points: 1200 },
                    'CH4': { name: 'Methane', formula: 'CH₄', points: 1300 },
                    'H2SO4': { name: 'Sulfuric Acid', formula: 'H₂SO₄', points: 2000 }
                };
                
                this.discoveredCompounds = new Set();
                
                this.initializeEventListeners();
                this.updateDisplay();
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('game-start');
                }
            }
            
            initializeEventListeners() {
                const chamber = document.getElementById('reactionChamber');
                
                chamber.addEventListener('click', (e) => {
                    if (e.target === chamber) {
                        this.selectedElement = null;
                        this.updateElementSelection();
                    }
                });
                
                chamber.addEventListener('dblclick', (e) => {
                    if (e.target === chamber) {
                        // Double-click to add random element
                        const elements = Object.keys(this.elementProperties);
                        const randomElement = elements[Math.floor(Math.random() * elements.length)];
                        this.addElementAt(randomElement, e.offsetX, e.offsetY);
                    }
                });
            }
            
            addElement(type) {
                const chamber = document.getElementById('reactionChamber');
                const rect = chamber.getBoundingClientRect();
                
                // Random position in chamber
                const x = Math.random() * (rect.width - 60) + 20;
                const y = Math.random() * (rect.height - 60) + 20;
                
                this.addElementAt(type, x, y);
            }
            
            addElementAt(type, x, y) {
                const element = document.createElement('div');
                element.className = `molecule ${type}`;
                element.textContent = this.elementProperties[type].symbol;
                element.style.left = x + 'px';
                element.style.top = y + 'px';
                element.dataset.type = type;
                element.dataset.id = Date.now() + Math.random();
                
                element.addEventListener('click', (e) => {
                    e.stopPropagation();
                    this.selectElement(element);
                });
                
                element.addEventListener('dblclick', (e) => {
                    e.stopPropagation();
                    this.removeElement(element);
                });
                
                this.makeDraggable(element);
                
                document.getElementById('reactionChamber').appendChild(element);
                this.elements.push(element);
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('liberation-beep');
                }
            }
            
            makeDraggable(element) {
                let isDragging = false;
                let startX, startY, initialX, initialY;
                
                element.addEventListener('mousedown', (e) => {
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    initialX = element.offsetLeft;
                    initialY = element.offsetTop;
                    e.preventDefault();
                });
                
                document.addEventListener('mousemove', (e) => {
                    if (!isDragging) return;
                    
                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    
                    element.style.left = (initialX + deltaX) + 'px';
                    element.style.top = (initialY + deltaY) + 'px';
                });
                
                document.addEventListener('mouseup', () => {
                    if (isDragging) {
                        isDragging = false;
                        this.checkForBonds(element);
                    }
                });
            }
            
            selectElement(element) {
                if (this.selectedElement && this.selectedElement !== element) {
                    // Create bond between selected elements
                    this.createBond(this.selectedElement, element);
                    this.selectedElement = null;
                } else {
                    this.selectedElement = element;
                }
                
                this.updateElementSelection();
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('neon-click');
                }
            }
            
            updateElementSelection() {
                this.elements.forEach(el => el.classList.remove('selected'));
                if (this.selectedElement) {
                    this.selectedElement.classList.add('selected');
                }
            }
            
            createBond(element1, element2) {
                // Check if bond already exists
                const existingBond = this.bonds.find(bond => 
                    (bond.element1 === element1 && bond.element2 === element2) ||
                    (bond.element1 === element2 && bond.element2 === element1)
                );
                
                if (existingBond) return;
                
                const bond = document.createElement('div');
                bond.className = 'bond';
                
                const rect1 = element1.getBoundingClientRect();
                const rect2 = element2.getBoundingClientRect();
                const chamber = document.getElementById('reactionChamber').getBoundingClientRect();
                
                const x1 = rect1.left - chamber.left + rect1.width / 2;
                const y1 = rect1.top - chamber.top + rect1.height / 2;
                const x2 = rect2.left - chamber.left + rect2.width / 2;
                const y2 = rect2.top - chamber.top + rect2.height / 2;
                
                const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
                const angle = Math.atan2(y2 - y1, x2 - x1);
                
                bond.style.left = x1 + 'px';
                bond.style.top = (y1 - 2) + 'px';
                bond.style.width = length + 'px';
                bond.style.transform = `rotate(${angle}rad)`;
                
                document.getElementById('reactionChamber').appendChild(bond);
                
                this.bonds.push({
                    element: bond,
                    element1: element1,
                    element2: element2
                });
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('collect');
                }
            }
            
            checkForBonds(element) {
                // Auto-bond with nearby elements
                this.elements.forEach(otherElement => {
                    if (otherElement === element) return;
                    
                    const rect1 = element.getBoundingClientRect();
                    const rect2 = otherElement.getBoundingClientRect();
                    
                    const distance = Math.sqrt(
                        (rect1.left - rect2.left) ** 2 + 
                        (rect1.top - rect2.top) ** 2
                    );
                    
                    if (distance < 80) {
                        this.createBond(element, otherElement);
                    }
                });
            }
            
            analyzeCompounds() {
                const compounds = this.identifyCompounds();
                
                if (compounds.length > 0) {
                    compounds.forEach(compound => {
                        if (this.knownCompounds[compound] && !this.discoveredCompounds.has(compound)) {
                            this.discoveredCompounds.add(compound);
                            this.score += this.knownCompounds[compound].points;
                            this.showAchievement(`Discovered ${this.knownCompounds[compound].name}!`, 
                                               `Formula: ${this.knownCompounds[compound].formula}`);
                        }
                    });
                }
                
                this.updateCompoundLibrary();
                this.updateDisplay();
                
                if (typeof botAudio !== 'undefined') {
                    if (compounds.length > 0) {
                        botAudio.playSound('level-up');
                    } else {
                        botAudio.playSound('glitch-error');
                    }
                }
            }
            
            identifyCompounds() {
                // Simple compound identification logic
                const elementCounts = {};
                
                this.elements.forEach(element => {
                    const type = element.dataset.type;
                    const symbol = this.elementProperties[type].symbol;
                    elementCounts[symbol] = (elementCounts[symbol] || 0) + 1;
                });
                
                const compounds = [];
                
                // Check for known compounds
                if (elementCounts['H'] >= 2 && elementCounts['O'] >= 1) {
                    compounds.push('H2O');
                }
                if (elementCounts['C'] >= 1 && elementCounts['O'] >= 2) {
                    compounds.push('CO2');
                }
                if (elementCounts['Na'] >= 1 && elementCounts['Cl'] >= 1) {
                    compounds.push('NaCl');
                }
                if (elementCounts['N'] >= 1 && elementCounts['H'] >= 3) {
                    compounds.push('NH3');
                }
                if (elementCounts['C'] >= 1 && elementCounts['H'] >= 4) {
                    compounds.push('CH4');
                }
                
                return compounds;
            }
            
            createReaction() {
                if (this.elements.length < 2) {
                    this.updateFormulaDisplay('Need at least 2 elements for a reaction!');
                    return;
                }
                
                // Create explosion effect
                const chamber = document.getElementById('reactionChamber');
                const explosion = document.createElement('div');
                explosion.className = 'reaction-explosion';
                explosion.style.left = (chamber.offsetWidth / 2 - 100) + 'px';
                explosion.style.top = (chamber.offsetHeight / 2 - 100) + 'px';
                
                chamber.appendChild(explosion);
                
                setTimeout(() => explosion.remove(), 1000);
                
                // Rearrange elements randomly
                this.elements.forEach(element => {
                    const newX = Math.random() * (chamber.offsetWidth - 60) + 20;
                    const newY = Math.random() * (chamber.offsetHeight - 60) + 20;
                    
                    element.style.transition = 'all 0.5s ease';
                    element.style.left = newX + 'px';
                    element.style.top = newY + 'px';
                    
                    setTimeout(() => {
                        element.style.transition = '';
                    }, 500);
                });
                
                // Check stability
                this.stability = Math.max(20, this.stability - 10);
                
                this.reactions++;
                this.score += 500;
                
                this.updateDisplay();
                this.updateFormulaDisplay('Reaction complete! Analyze for compounds.');
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('explosion');
                }
            }
            
            removeElement(element) {
                // Remove associated bonds
                this.bonds = this.bonds.filter(bond => {
                    if (bond.element1 === element || bond.element2 === element) {
                        bond.element.remove();
                        return false;
                    }
                    return true;
                });
                
                // Remove element
                element.remove();
                const index = this.elements.indexOf(element);
                if (index > -1) {
                    this.elements.splice(index, 1);
                }
                
                if (this.selectedElement === element) {
                    this.selectedElement = null;
                }
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('glitch-error');
                }
            }
            
            clearLab() {
                this.elements.forEach(element => element.remove());
                this.bonds.forEach(bond => bond.element.remove());
                
                this.elements = [];
                this.bonds = [];
                this.selectedElement = null;
                this.stability = 100;
                
                this.updateDisplay();
                this.updateFormulaDisplay('Lab cleared. Ready for new experiments.');
                
                if (typeof botAudio !== 'undefined') {
                    botAudio.playSound('neon-click');
                }
            }
            
            updateCompoundLibrary() {
                const library = document.getElementById('compoundLibrary');
                
                if (this.discoveredCompounds.size === 0) {
                    library.innerHTML = '<div style="text-align: center; color: #ccc;">No compounds discovered yet</div>';
                } else {
                    library.innerHTML = '';
                    this.discoveredCompounds.forEach(compound => {
                        const item = document.createElement('div');
                        item.className = 'compound-item';
                        item.textContent = `${this.knownCompounds[compound].name} (${this.knownCompounds[compound].formula})`;
                        library.appendChild(item);
                    });
                }
            }
            
            updateFormulaDisplay(message) {
                document.getElementById('formulaDisplay').textContent = message;
            }
            
            updateDisplay() {
                document.getElementById('compounds').textContent = this.discoveredCompounds.size;
                document.getElementById('reactions').textContent = this.reactions;
                document.getElementById('score').textContent = this.score.toLocaleString();
                document.getElementById('stability').textContent = this.stability + '%';
            }
            
            showAchievement(title, description) {
                const popup = document.getElementById('achievementPopup');
                const text = document.getElementById('achievementText');
                
                text.innerHTML = `<strong>⚗️ ${title}</strong><br>${description}`;
                popup.classList.add('show');
                
                setTimeout(() => {
                    popup.classList.remove('show');
                }, 4000);
            }
        }
        
        let chemLab;
        
        function startChemLab() {
            chemLab = new ChemistryLiberationLab();
        }
        
        function addElement(type) {
            chemLab.addElement(type);
        }
        
        function analyzeCompounds() {
            chemLab.analyzeCompounds();
        }
        
        function createReaction() {
            chemLab.createReaction();
        }
        
        function clearLab() {
            chemLab.clearLab();
        }
        
        // Initialize when page loads
        window.addEventListener('load', startChemLab);
    </script>
</body>
</html>